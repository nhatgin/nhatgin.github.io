(function(t){function e(e){for(var r,o,u=e[0],i=e[1],l=e[2],d=0,b=[];d<u.length;d++)o=u[d],Object.prototype.hasOwnProperty.call(c,o)&&c[o]&&b.push(c[o][0]),c[o]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);s&&s(e);while(b.length)b.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,u=1;u<n.length;u++){var i=n[u];0!==c[i]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},c={app:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],i=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var s=i;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"396d":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r,c=n("7a23"),a=(n("396d"),n("99af"),n("d3b7"),n("ac1f"),n("1276"),n("5530")),o=(n("96cf"),n("1da1")),u=n("dba1"),i=n("bc3a"),l=n.n(i),s="".concat("http://localhost:4000","/accounts"),d=new u["a"](null),b={login:p,apiAuthenticate:g,logout:j,getAll:v,getById:h,update:m,delete:k,account:d.asObservable(),get accountValue(){return d.value}};function p(){return f.apply(this,arguments)}function f(){return f=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,new Promise(FB.login);case 2:if(e=t.sent,n=e.authResponse,n){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,g(n.accessToken);case 8:r=yt.currentRoute.value.query["returnUrl"]||"/",yt.push(r);case 10:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function g(t){return O.apply(this,arguments)}function O(){return O=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l.a.post("".concat(s,"/authenticate"),{accessToken:e});case 2:return n=t.sent,r=n.data,d.next(r),x(),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)}))),O.apply(this,arguments)}function j(){FB.api("/me/permissions","delete",null,(function(){return FB.logout()})),I(),d.next(null),yt.push("/login")}function v(){return l.a.get(s).then((function(t){return t.data}))}function h(t){return l.a.get("".concat(s,"/").concat(t)).then((function(t){return t.data}))}function m(t,e){return y.apply(this,arguments)}function y(){return y=Object(o["a"])(regeneratorRuntime.mark((function t(e,n){var r,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l.a.put("".concat(s,"/").concat(e),n);case 2:return c=t.sent,o=c.data,o.id===(null===(r=d.value)||void 0===r?void 0:r.id)&&(o=Object(a["a"])(Object(a["a"])({},d.value),o),d.next(o)),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function k(t){return w.apply(this,arguments)}function w(){return w=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l.a.delete("".concat(s,"/").concat(e));case 2:e===(null===(n=d.value)||void 0===n?void 0:n.id)&&j();case 3:case"end":return t.stop()}}),t)}))),w.apply(this,arguments)}function x(){var t=JSON.parse(atob(d.value.token.split(".")[1])),e=new Date(1e3*t.exp),n=e.getTime()-Date.now()-6e4,c=FB.getAuthResponse(),a=c.accessToken;r=setTimeout((function(){return g(a)}),n)}function I(){clearTimeout(r)}function S(t){var e=b.accountValue;return!!e||(yt.push({path:"/login",query:{returnUrl:t.fullPath}}),!1)}n("caad");function T(){l.a.interceptors.response.use(null,(function(t){var e,n=t.response;if(n){[401,403].includes(n.status)&&b.accountValue&&b.logout();var r=(null===(e=n.data)||void 0===e?void 0:e.message)||n.statusText;console.error("ERROR:",r)}else console.error(t)}))}n("4de4"),n("7db0"),n("4160"),n("d81d"),n("b0c0"),n("8a79"),n("466d");var B=n("2909"),R="vue-3-facebook-login-accounts",A=JSON.parse(localStorage.getItem(R))||[];function E(){var t=["get","post","put","delete"];t.forEach((function(t){l.a["original".concat(t)]=l.a[t],l.a[t]=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),c=1;c<n;c++)r[c-1]=arguments[c];return new Promise((function(n,c){return o();function o(){switch(!0){case e.endsWith("/accounts/authenticate")&&"post"===t:return u();case e.endsWith("/accounts")&&"get"===t:return i();case e.match(/\/accounts\/\d+$/)&&"get"===t:return s();case e.match(/\/accounts\/\d+$/)&&"put"===t:return d();case e.match(/\/accounts\/\d+$/)&&"delete"===t:return p();default:return l.a["original".concat(t)](e,v()).then((function(t){return n(t)})).catch((function(t){return c(t)}))}}function u(){var t=v(),e=t.accessToken;l.a.get("https://graph.facebook.com/v8.0/me?access_token=".concat(e)).then((function(t){var e=t.data;if(e.error)return g(e.error.message);var n=A.find((function(t){return t.facebookId===e.id}));return n||(n={id:h(),facebookId:e.id,name:e.name,extraInfo:"This is some extra info about ".concat(e.name," that is saved in the API")},A.push(n),localStorage.setItem(R,JSON.stringify(A))),f(Object(a["a"])(Object(a["a"])({},n),{},{token:m(n)}))}))}function i(){return O()?f(A):g()}function s(){if(!O())return g();var t=A.find((function(t){return t.id===j()}));return f(t)}function d(){if(!O())return g();var t=v(),e=A.find((function(t){return t.id===j()}));return Object.assign(e,t),localStorage.setItem(R,JSON.stringify(A)),f(e)}function p(){return O()?(A=A.filter((function(t){return t.id!==j()})),localStorage.setItem(R,JSON.stringify(A)),f()):g()}function f(t){setTimeout((function(){return n({status:200,data:t})}),500)}function g(){setTimeout((function(){var t={status:401,data:{message:"Unauthorized"}};c(t);var e=l.a.interceptors.response.handlers[0].rejected;e({response:t})}),500)}function O(){return b.accountValue}function j(){var t=e.split("/");return parseInt(t[t.length-1])}function v(){if(["post","put"].includes(t))return r[0]}function h(){return A.length?Math.max.apply(Math,Object(B["a"])(A.map((function(t){return t.id}))))+1:1}function m(t){var e={exp:Math.round(new Date(Date.now()+9e5).getTime()/1e3),id:t.id};return"fake-jwt-token.".concat(btoa(JSON.stringify(e)))}}))}}))}var P="2067528693388713";function _(){return new Promise((function(t){window.fbAsyncInit=function(){FB.init({appId:P,cookie:!0,xfbml:!0,version:"v8.0"}),FB.getLoginStatus((function(e){var n=e.authResponse;n?b.apiAuthenticate(n.accessToken).then(t):t()}))},function(t,e,n){var r,c=t.getElementsByTagName(e)[0];t.getElementById(n)||(r=t.createElement(e),r.id=n,r.src="https://connect.facebook.net/en_US/sdk.js",c.parentNode.insertBefore(r,c))}(document,"script","facebook-jssdk")}))}n("2ca0");function F(){l.a.interceptors.request.use((function(t){var e=b.accountValue,n=null===e||void 0===e?void 0:e.token,r=t.url.startsWith("http://localhost:4000");return n&&r&&(t.headers.common.Authorization="Bearer ".concat(e.token)),t}))}var N=n("6c02"),V=Object(c["g"])("h2",null,"You're logged in with Vue 3 & Facebook!!",-1),D=Object(c["g"])("p",null,"All accounts from secure api end point:",-1),J={class:"table table-striped"},M=Object(c["g"])("thead",null,[Object(c["g"])("tr",null,[Object(c["g"])("th",null,"Id"),Object(c["g"])("th",null,"Facebook Id"),Object(c["g"])("th",null,"Name"),Object(c["g"])("th",null,"Extra Info"),Object(c["g"])("th")])],-1),C={class:"text-right",style:{"white-space":"nowrap"}},U=Object(c["f"])("Edit"),q={key:0,class:"spinner-border spinner-border-sm"},z={key:1},L={key:0},W=Object(c["g"])("td",{colspan:"5",class:"text-center"},[Object(c["g"])("span",{class:"spinner-border spinner-border-lg align-center"})],-1);function $(t,e,n,r,a,o){var u=Object(c["u"])("router-link");return Object(c["p"])(),Object(c["d"])(c["a"],null,[V,D,Object(c["g"])("table",J,[M,Object(c["g"])("tbody",null,[(Object(c["p"])(!0),Object(c["d"])(c["a"],null,Object(c["t"])(r.accounts,(function(t){return Object(c["p"])(),Object(c["d"])("tr",{key:t.id},[Object(c["g"])("td",null,Object(c["w"])(t.id),1),Object(c["g"])("td",null,Object(c["w"])(t.facebookId),1),Object(c["g"])("td",null,Object(c["w"])(t.name),1),Object(c["g"])("td",null,Object(c["w"])(t.extraInfo),1),Object(c["g"])("td",C,[Object(c["g"])(u,{to:"/edit/".concat(t.id),class:"btn btn-sm btn-primary mr-1"},{default:Object(c["B"])((function(){return[U]})),_:2},1032,["to"]),Object(c["g"])("button",{onClick:function(e){return r.deleteAccount(t.id)},class:"btn btn-sm btn-danger btn-delete-account",disabled:t.isDeleting},[t.isDeleting?(Object(c["p"])(),Object(c["d"])("span",q)):(Object(c["p"])(),Object(c["d"])("span",z,"Delete"))],8,["onClick","disabled"])])])})),128)),r.accounts?Object(c["e"])("",!0):(Object(c["p"])(),Object(c["d"])("tr",L,[W]))])])],64)}var H={setup:function(){var t=Object(c["s"])();b.getAll().then((function(e){return t.value=e}));var e=function(e){var n=t.value.find((function(t){return t.id===e}));n.isDeleting=!0,b.delete(e).then((function(){return t.value=t.value.filter((function(t){return t.id!==e}))}))};return{accounts:t,deleteAccount:e}}};H.render=$;var Y=H,G=Object(c["g"])("h2",null,"Edit Account",-1),K=Object(c["g"])("p",null,"Updating the information here will only change it inside this application, it won't (and can't) change anything in the associated Facebook account.",-1),Q={class:"form-group"},X=Object(c["g"])("label",null,"Facebook Id",-1),Z={class:"form-group"},tt=Object(c["g"])("label",null,"Name",-1),et={class:"form-group"},nt=Object(c["g"])("label",null,"Extra Info",-1),rt={class:"form-group"},ct={key:0,class:"spinner-border spinner-border-sm mr-1"},at=Object(c["f"])(" Save "),ot=Object(c["f"])("Cancel"),ut={key:0,class:"alert alert-danger mt-3 mb-0"},it={key:1,class:"text-center p-3"},lt=Object(c["g"])("span",{class:"spinner-border spinner-border-lg align-center"},null,-1);function st(t,e,n,r,a,o){var u=Object(c["u"])("router-link");return Object(c["p"])(),Object(c["d"])(c["a"],null,[G,K,r.account?(Object(c["p"])(),Object(c["d"])("form",{key:0,onSubmit:e[3]||(e[3]=Object(c["D"])((function(){return r.handleSubmit.apply(r,arguments)}),["prevent"]))},[Object(c["g"])("div",Q,[X,Object(c["g"])("div",null,Object(c["w"])(r.account.facebookId),1)]),Object(c["g"])("div",Z,[tt,Object(c["C"])(Object(c["g"])("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=function(t){return r.account.name=t}),class:"form-control"},null,512),[[c["y"],r.account.name]])]),Object(c["g"])("div",et,[nt,Object(c["C"])(Object(c["g"])("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=function(t){return r.account.extraInfo=t}),class:"form-control"},null,512),[[c["y"],r.account.extraInfo]])]),Object(c["g"])("div",rt,[Object(c["g"])("button",{type:"submit",disabled:r.loading,class:"btn btn-primary"},[r.loading?(Object(c["p"])(),Object(c["d"])("span",ct)):Object(c["e"])("",!0),at],8,["disabled"]),Object(c["g"])(u,{to:"../../",class:"btn btn-link"},{default:Object(c["B"])((function(){return[ot]})),_:1}),r.error?(Object(c["p"])(),Object(c["d"])("div",ut,Object(c["w"])(r.error),1)):Object(c["e"])("",!0)])],32)):Object(c["e"])("",!0),r.account?Object(c["e"])("",!0):(Object(c["p"])(),Object(c["d"])("div",it,[lt]))],64)}var dt={setup:function(){var t=Object(N["c"])(),e=Object(c["s"])(),n=t.params.id;b.getById(n).then((function(t){return e.value=t}));var r=Object(c["s"])(!1),a=Object(c["s"])(""),o=function(){r.value=!0,a.value="",b.update(n,e.value).then((function(){yt.push("../")})).catch((function(t){a.value=t,r.value=!1}))};return{account:e,loading:r,error:a,handleSubmit:o}}};dt.render=st;var bt=dt,pt={class:"col-md-6 offset-md-3 mt-5 text-center"},ft={class:"card"},gt=Object(c["g"])("h4",{class:"card-header"},"Vue 3 Facebook Login Example",-1),Ot={class:"card-body"};function jt(t,e,n,r,a,o){return Object(c["p"])(),Object(c["d"])("div",pt,[Object(c["g"])("div",ft,[gt,Object(c["g"])("div",Ot,[Object(c["g"])("div",{class:"fb-login-button",onClick:e[1]||(e[1]=function(){return r.login.apply(r,arguments)}),"data-width":"","data-size":"large","data-button-type":"continue_with","data-layout":"rounded","data-auto-logout-link":"false","data-use-continue-as":"true"})])])])}var vt={setup:function(){return b.accountValue&&yt.push("/"),{login:b.login}}};vt.render=jt;var ht=vt,mt=[{path:"/",component:Y,beforeEnter:S},{path:"/edit/:id",component:bt,beforeEnter:S},{path:"/login",component:ht},{path:"/:pathMatch(.*)*",redirect:"/"}],yt=Object(N["a"])({history:Object(N["b"])(),routes:mt}),kt={key:0,class:"navbar navbar-expand navbar-dark bg-dark"},wt={class:"navbar-nav"},xt=Object(c["f"])("Home"),It={class:"container pt-4"};function St(t,e,n,r,a,o){var u=Object(c["u"])("router-link"),i=Object(c["u"])("router-view");return Object(c["p"])(),Object(c["d"])(c["a"],null,[r.account?(Object(c["p"])(),Object(c["d"])("nav",kt,[Object(c["g"])("div",wt,[Object(c["g"])(u,{to:"/",class:"nav-item nav-link"},{default:Object(c["B"])((function(){return[xt]})),_:1}),Object(c["g"])("a",{class:"nav-item nav-link",onClick:e[1]||(e[1]=function(){return r.logout.apply(r,arguments)})},"Logout")])])):Object(c["e"])("",!0),Object(c["g"])("div",It,[Object(c["g"])(i)])],64)}var Tt={setup:function(){var t=Object(c["s"])(null);return b.account.subscribe((function(e){return t.value=e})),{account:t,logout:b.logout}}};Tt.render=St;var Bt=Tt;function Rt(){Object(c["c"])(Bt).use(yt).mount("#app")}E(),F(),T(),_().then(Rt)}});
//# sourceMappingURL=app.1246f8e2.js.map